import React, { useEffect, useRef, useState } from 'react'
import { gsap } from 'gsap'
import { Link } from 'react-router-dom'

import { DrawSVGPlugin } from 'gsap/DrawSVGPlugin'
import { Flip } from 'gsap/Flip'

gsap.registerPlugin(DrawSVGPlugin)
gsap.registerPlugin(Flip)

const BackButton = (props) => {
    const tl = useRef(null)

    // useEffect(() => {
    //     const state = Flip.getState('.gallery__button--back')

    //     gsap.set('.gallery__button--back', { rotate: 333 })

    //     Flip.from(state, {
    //         scale: true,
    //         duration: 1,
    //         repeat: 1,
    //         repeatDelay: 1.5,
    //         ease: 'power1.inOut',
    //         paused: false,
    //     })
    //         .progress(1)
    //         .progress(0)
    // }, [])

    useEffect(() => {
        tl.current = gsap.timeline({ reversed: true }).fromTo(
            '.gallery__button--back',
            0.2,
            { drawSVG: '%0 %10' },
            {
                scale: 1.1,
                color: '#800080',
                drawSVG: '%90 %100',
                stagger: 0.3,
            }
        )

        return () => {
            tl.current.kill()
        }
    }, [])

    useEffect(() => {
        gsap.from('.gallery__button--back-a', 2, {
            opacity: 0.5,
            repeat: -1,
            yoyo: true,
            stagger: { from: 'random', amount: 0.4 },
            repeatDelay: 0.1,
        })
    }, [])

    const onMouseEnterHandler = () => {
        tl.current.play()
    }
    const onMouseLeaveHandler = () => {
        tl.current.reverse()
    }

    const back =
        props.selected === 0 ? props.animations.length - 1 : props.selected - 1
    const backUrl = `/animation-${back}`
    const handleBack = () => {
        props.setSelected(back)
    }

    return (
        <Link to={backUrl} onClick={handleBack}>
            <svg
                id="Layer_1"
                data-name="Layer 1"
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 255 158"
                onMouseEnter={onMouseEnterHandler}
                onMouseLeave={onMouseLeaveHandler}
                className="gallery__button--back"
            >
                <title>Untitled-1</title>
                <path
                    d="M180.53,333.08l-1.41-.46-1.4-.39a69.94,69.94,0,0,1,11.67,5.85,139.07,139.07,0,0,1,11.78,8.33c4,3.08,8.1,6.41,12.45,9.72a148.23,148.23,0,0,0,14,9.65c1.16.93,3.61,2.72,4.93,3.55a48.85,48.85,0,0,0,20.13,4.73,45.14,45.14,0,0,0,11.58-1.31c.95-.26,1.87-.49,2.81-.8s1.88-.63,2.77-1a41.32,41.32,0,0,0,5.08-2.49,16,16,0,0,0,6.28-6.79,13.61,13.61,0,0,0,1.26-3.78,4.74,4.74,0,0,0,.43-2.48c-.11-.65-.51-1-1.29-.6a33.92,33.92,0,0,1-5.2,4.13c-2,1.21-3.79,1.82-4.13,1.23-.16-.29,1.09-1,2.29-1.86-.39-.57-.08-2,.29-3.42a10.05,10.05,0,0,1,1.28-3.24,43.47,43.47,0,0,0,1.8-4.94,14.08,14.08,0,0,0,.56-4.88c.14-1.95-2-.38-4.25.72a38.48,38.48,0,0,1-3.7,1.62c-1.21.47-2.35.79-3.1,1.12s-1.09-.11-1.24-.6a3.89,3.89,0,0,0-.52-1.49,2.5,2.5,0,0,1-1.47.88,3.81,3.81,0,0,0-.79.25,2.39,2.39,0,0,0-.79.48c-.08-.16-1.07.2-2.31.49-.31.08-.64.13-1,.21l-1.06.19c-.34.09-.71.09-1,.15a8.18,8.18,0,0,1-.92.11,3.28,3.28,0,0,1-.64.24,4.2,4.2,0,0,1-.94.17,7.48,7.48,0,0,1-1.5.07c-.81,0-.83.32-.85.66l0-.68c-.87.63-2.5-.22-3.42-.05l.11-.68c-1.84.39-3.46-.73-5.32-1L244,344c-.87-.26-1.75-.63-1.63-.94l.24-.64c-.73-.62-2.73-.73-2.45-1.37l-.28.62a28.54,28.54,0,0,1-4.55-2.53c-1.37-.91-2.62-1.87-3.87-2.87a151,151,0,0,0-27.3-18.78c-1.19-.72-2.77-.79-1.88.48-1.21-.69-2.44-1.37-3.69-2-2.55-1.27-1.7.25-4.28-.94a81.84,81.84,0,0,0-17.13-4.5,54.8,54.8,0,0,0-9.37-.46,45.68,45.68,0,0,0-4.93.46l-2.46.46c-.82.16-1.61.4-2.42.6a43,43,0,0,0-9.17,3.75,39.7,39.7,0,0,0-8.15,6.05,32.82,32.82,0,0,0-6.4,8.55A30.45,30.45,0,0,0,131,340.66a31.49,31.49,0,0,1,3.61-9.5,56.46,56.46,0,0,1,5.59-7.79c.25.23.75.69,1.91-.47a41.2,41.2,0,0,1,12.19-7.79c4.18-1.7,8.18-2.25,10.58-1.82a20.45,20.45,0,0,1,2.7.59,28.75,28.75,0,0,0,4.7.58c-.71-.07-1.43,0-2.15-.07s-1.44,0-2.16,0l0,1a46.51,46.51,0,0,1,9,1.09,50,50,0,0,1,8.3,2.64l-.33,1c.82.27,1.62.59,2.43.88.38.79-.16,1-1.24,1a42.77,42.77,0,0,1-4.67-.86,63,63,0,0,0-6.25-1.06,34.54,34.54,0,0,0-5.76-.21v1.36c.81,0,1.62,0,2.43.07l0,.68a31,31,0,0,0-10,.92,30.43,30.43,0,0,0-9.15,4.14c.49-.33,1.25-.79,2-1.25s1.57-.85,2.12-1.08c.14.31.29.62,1.35.16a27.45,27.45,0,0,0-6.55,3.69,16.34,16.34,0,0,0-4.8,5.65c-.18.56.11.73.7.48a13.33,13.33,0,0,0,2.66-1.95,20.46,20.46,0,0,1,1.6-1.53,17,17,0,0,1,1.58-1.28,15.16,15.16,0,0,1,1.69-1.15l.92-.57,1-.54.31.61a27.62,27.62,0,0,0-3.21,1.79,10.58,10.58,0,0,0-2.71,2.41c-.24.49.3.3.83.14s1.09-.26.83.18a6.56,6.56,0,0,0-1,1,3.51,3.51,0,0,0-.74,1.25,18.27,18.27,0,0,1,7.67-5.73c1.05-.08,2.05-.14,2.3.53a10.65,10.65,0,0,1,10.95,1,10.56,10.56,0,0,0,3.39.92A42,42,0,0,1,180.53,333.08Z"
                    transform="translate(-51 -230)"
                    className="button-2"
                    className="gallery__button--back-a"
                    fill="#e36869"
                    stroke="#e36869"
                    strokeWidth="1px"
                />
                <path
                    d="M170.64,299.27l-1.7-.62-1.7-.51c9.42,3.67,18.76,9.77,27.59,17.06S212.54,331,222,339c1.07,1.16,3.29,3.47,4.48,4.6a67.29,67.29,0,0,0,8.7,5.55c1.62.91,3.35,1.68,5.08,2.48s3.54,1.47,5.39,2.07,3.72,1.15,5.58,1.65,3.78.89,5.71,1.15a61.21,61.21,0,0,0,11.28.77,17.24,17.24,0,0,0,5.07-.89,20,20,0,0,0,2.12-.8c.65-.32,1.25-.65,1.78-1a15.88,15.88,0,0,0,2.4-1.71c.54-.47.82-.77.82-.77,1.63-1,2.91-2.73,1.1-3-.84.09-2,.28-3.22.44s-2.58.23-3.81.24a21.9,21.9,0,0,1-3.17-.25c-.81-.18-1.31-.45-1.31-.79,0-.17.39-.26,1-.3s1.38-.12,2.17-.16c-.05-.71,1.06-1.72,2.26-2.78a15.33,15.33,0,0,1,1.82-1.34,5.28,5.28,0,0,1,1.43-.74c.32-.25,1.08-.64,2-1.18s2-1.22,3.07-2a24.43,24.43,0,0,0,4.31-3.77c1.66-1.48-1.14-1.67-4.27-1.92-.82-.1-1.68-.18-2.52-.25s-1.73-.24-2.55-.32c-1.66-.26-3.16-.46-4.31-.6-2.26-.38-.19-1.7-.36-2.71a4.94,4.94,0,0,1-2.58.06,8.56,8.56,0,0,0-2.64-.12,16.85,16.85,0,0,0-3.59-.72l-1.56-.29c-.54-.1-1.08-.25-1.61-.36-1.06-.2-2.08-.51-2.9-.69,0,0-1.18.12-4.46-1-1.09-.37-1.21-.05-1.32.27l.23-.64a4.3,4.3,0,0,1-2.27-.58,9.34,9.34,0,0,0-2.16-.9l.28-.62a9.41,9.41,0,0,1-3.26-1.28A26.3,26.3,0,0,0,243,322l.34-.59c-1-.62-2.1-1.27-1.92-1.57l.37-.58a9,9,0,0,0-1.93-1.29c-.67-.4-1.19-.75-1-1l-.39.57a77.3,77.3,0,0,1-10-8.33A138.73,138.73,0,0,0,214.52,297c-2.7-2.09-5.53-4.15-8.55-6.17s-6.13-3.88-9.26-5.61c-1.38-.82-3.09-1-2.08.36-1.34-.82-2.75-1.6-4.15-2.36-2.85-1.5-1.89.16-4.76-1.28a98.15,98.15,0,0,0-19-5.64,65.46,65.46,0,0,0-10.25-1.07h-3.27l-.71,0-1.43.09c-.95.05-1.89.17-2.81.31s-1.87.26-2.77.47a44.85,44.85,0,0,0-10.59,3.53,41.07,41.07,0,0,0-9.69,6.33,33.22,33.22,0,0,0-7.7,10.06,28.5,28.5,0,0,0-2.9,13.28,28.94,28.94,0,0,1,3.19-11.92c.46-.84.92-1.67,1.39-2.5s1.06-1.54,1.6-2.33,1.16-1.47,1.75-2.24c.31-.37.61-.77.93-1.13l1-1.07c.24.25.72.7,2.11-.61a44.59,44.59,0,0,1,14.41-8c4.85-1.57,9.39-1.9,12.09-1.31a42.61,42.61,0,0,0,8.1,1.68c-.79-.12-1.6-.13-2.4-.2s-1.6-.14-2.41-.13l0,1a58.78,58.78,0,0,1,10,1.69,63.09,63.09,0,0,1,9.38,3.24l-.35,1c.94.32,1.84.71,2.76,1.08.88,1.69-2.31.77-6.7-.34-1.1-.28-2.28-.58-3.49-.82-.61-.13-1.22-.28-1.83-.39l-1.84-.31a43,43,0,0,0-6.62-.61l-.07,1.37c.94.08,1.88.09,2.81.23l-.07.68a40.27,40.27,0,0,0-11.75.25,34.75,34.75,0,0,0-11,4.12,24.89,24.89,0,0,1,2.45-1.3l1.37-.65,1.17-.45c.12.32.24.63,1.51.16a32.51,32.51,0,0,0-7.9,3.85,17.81,17.81,0,0,0-5.86,6.29c-.22.64.08.81.7.48a4.3,4.3,0,0,0,.52-.33c.21-.13.45-.29.71-.48.5-.38,1.06-.89,1.8-1.45.33-.32.62-.65,1-.92l1-.8a21.37,21.37,0,0,1,1.93-1.39,33.12,33.12,0,0,1,4.45-2.4l.27.63c-.56.27-1.2.55-1.88.84s-1.34.69-2,1.05-1.28.84-1.88,1.26a18.07,18.07,0,0,0-1.46,1.38c-.67,1,2.49-.71,1.79.31a7.31,7.31,0,0,0-2.2,2.5,23.8,23.8,0,0,1,4.18-3.67,17.31,17.31,0,0,1,5.25-2.52c1.21-.15,2.44-.09,2.62.55a11.6,11.6,0,0,1,2-.57,10,10,0,0,1,1.92-.29c.31,0,.62-.06.92-.07l.89,0a10.92,10.92,0,0,1,1.75.2c.59.11,1.16.24,1.71.37a14.51,14.51,0,0,1,1.57.56,12.48,12.48,0,0,1,2.69,1.43,18.25,18.25,0,0,0,4.19,1.22l1.53.37c.53.13,1.05.3,1.57.44C168.8,298.61,169.79,299,170.64,299.27Z"
                    transform="translate(-51 -230)"
                    fill="#e36869"
                    stroke="#e36869"
                    strokeWidth="1px"
                    className="gallery__button--back-a"
                />
                <path
                    d="M157.38,275.43c-1.23-.47-2.45-.89-3.68-1.29a161.18,161.18,0,0,1,15.53,7.59c5.31,2.88,10.56,5.92,15.62,9.16s10,6.64,14.55,10.26,8.92,7.47,13.13,11.51l3.77,4.67a138.3,138.3,0,0,0,15.47,12.34A113.11,113.11,0,0,0,250.14,340a19.74,19.74,0,0,0,2.28.84,17.84,17.84,0,0,0,2.27.45,21.56,21.56,0,0,0,4,.21,18.71,18.71,0,0,0,3.82-.63c1.78,0,3.74-.83,2.43-2-.72-.36-1.73-.8-2.83-1.28l-1.69-.75-1.62-.87a20.55,20.55,0,0,1-2.61-1.63c-.63-.5-.94-1-.8-1.27s.46-.05,1,.16,1.26.51,2,.82c.28-.62,1.75-1.09,3.29-1.35a9.69,9.69,0,0,1,3.89-.17c.41,0,1.27.05,2.37.08l3.75.1a18.08,18.08,0,0,0,1.95,0l1.76-.09a18.67,18.67,0,0,0,2.28-.23c2.27-.1.26-2-2.45-4.23l-1.07-.83L273,326.4c-.76-.61-1.53-1.21-2.28-1.76a43.11,43.11,0,0,0-4-3c-2.13-1.68.66-1.57,1-2.54a9.24,9.24,0,0,1-2.83-1.42,12.09,12.09,0,0,0-2.8-1.54c.08-.18-1.57-1.1-3.62-2.46s-4.55-2.94-6.24-4a11.4,11.4,0,0,1-1.07-.51,31.28,31.28,0,0,1-3.61-2.23c-1.12-.79-1.32-.51-1.52-.23l.4-.56c-1.52-.21-3.37-2.43-4.7-3l.41-.55c-2.66-1.12-4.49-3.37-7-4.87l.42-.54c-1.13-.88-2.26-1.75-2.06-2l.42-.54c-.94-1.16-3.65-2.41-3.23-2.95l-.42.54c-4.63-3.62-8-6.64-11.5-9.65a102.79,102.79,0,0,0-16.36-12,181.71,181.71,0,0,0-19-9.92c-1.38-.71-3.06-.8-2,.51-1.38-.69-2.73-1.38-4.15-2.05-2.81-1.35-1.84.25-4.69-1.06a140.58,140.58,0,0,0-18.86-5.86,72.4,72.4,0,0,0-10.39-1.56,56.32,56.32,0,0,0-11,.21,46.9,46.9,0,0,0-21.3,8.17,39.12,39.12,0,0,0-8.7,8.46A34,34,0,0,0,96.67,279a34,34,0,0,1,5.66-10.11A55.25,55.25,0,0,1,110,261c.21.27.61.77,2.15-.31a47.79,47.79,0,0,1,15.24-6.8,34.79,34.79,0,0,1,3.71-.69l1.74-.21c.57,0,1.13-.06,1.67-.07s1.05,0,1.53,0,.93.06,1.36.11a11.2,11.2,0,0,1,2.26.4c.86.19,1.71.53,2.94.93a37.62,37.62,0,0,0,5.3,1.16c-.81-.14-1.62-.25-2.45-.34S143.8,255,143,255l-.08,1a63.5,63.5,0,0,1,10.21,2.18,79.42,79.42,0,0,1,9.47,3.53l-.36.95c.95.35,1.88.74,2.81,1.11.93,1.69-2.35.8-6.84-.46-2.25-.61-4.82-1.3-7.32-1.81a50.67,50.67,0,0,0-6.8-.94l-.14,1.36c1,.11,1.93.21,2.9.38l-.11.68c-8.54-1.33-16.06-.73-23.9,2.91.66-.28,1.63-.75,2.65-1.12s2-.74,2.72-.92c.1.33.19.65,1.55.27a36.09,36.09,0,0,0-8.54,3.28,21.52,21.52,0,0,0-6.91,5.83c-.62,1.29.91.75,4.12-1.43a30.62,30.62,0,0,1,4.42-2.83l1.1-.58c.38-.18.77-.34,1.17-.52.79-.37,1.66-.66,2.59-1l.22.64a39.7,39.7,0,0,0-4.25,1.65,16,16,0,0,0-2.09,1.14c-.33.21-.64.41-.93.62s-.54.45-.77.67c-.42.51.25.34.9.19s1.33-.22.89.23a8.81,8.81,0,0,0-2.68,2.44c2.61-2.35,6.94-5,10.66-5.68,1.28-.06,2.55.07,2.68.72a16.29,16.29,0,0,1,4.15-.59,17.47,17.47,0,0,1,3.89.38,16.72,16.72,0,0,1,6.16,2.67,4.92,4.92,0,0,0,1.62.68c.78.26,1.75.48,2.81.79C153.06,274,155.53,274.72,157.38,275.43Z"
                    transform="translate(-51 -230)"
                    stroke="#e36869"
                    fill="#e36869"
                    strokeWidth="1px"
                    className="gallery__button--back-a"
                />
                <path
                    d="M131.2,266.78c-1.79.3-3.58.48-5.34.86a131.23,131.23,0,0,1,23.15-1,126.8,126.8,0,0,1,23,3.64,115,115,0,0,1,21.36,8.3,96,96,0,0,1,18,12.42c1.19,1.34,3.4,4.13,4.52,5.46.65.58,1.21,1.25,1.81,1.9l1.83,2,1.9,2,1.79,2.13,1.82,2.13c.62.71,1.25,1.41,1.85,2.2,1.22,1.53,2.48,3.16,3.79,4.87,5.24,6.82,11.38,14.94,19.43,21.36A27.73,27.73,0,0,0,262,340.38a25,25,0,0,0,4,.43c1,0,1.49,0,1.49,0,2.69.31,5.45-.35,3.29-1.71l-2-.83-2.31-1.08a41.4,41.4,0,0,1-4.66-2.76c-2.88-2-4.86-4-4.44-4.55.21-.27,1.95,1.09,3.82,2.31.39-.58,2.32-.51,4.37-.38a24,24,0,0,1,5.16.74,47.6,47.6,0,0,0,8.24.39,23.63,23.63,0,0,0,4.78-.87l.93-.29c.29-.1.55-.22.78-.31.46-.2.8-.36,1-.48,1.41-.55,1.31-1.05.24-1.49-.58-.2-1.21-.47-2-.72-.38-.1-.8-.29-1.23-.44s-.88-.31-1.35-.52a32.11,32.11,0,0,1-5.61-3c-1.8-1.17-3.4-2.45-4.64-3.37s-.95-1.4-.4-1.64,1.44-.33,1.67-.79a8.73,8.73,0,0,1-3-2,18.41,18.41,0,0,0-2.82-2.36c.05-.07-.31-.51-.93-1.16s-1.56-1.68-2.57-2.86c-2-2.31-4.46-5.49-6.18-7.72,0,0-.36-.33-1.15-1.22s-2-2.37-3.84-4.8c-1.25-1.63-1.52-1.42-1.79-1.21l.54-.42c-1.79-1.2-3.88-5-5.7-6.43l.52-.44a40.63,40.63,0,0,1-4.64-4.73,51.27,51.27,0,0,0-4.75-4.57l.46-.5c-.8-.76-1.6-1.53-2.17-2.13s-1-1-.85-1.12l.45-.51c-1.49-1.69-5.36-4-4.93-4.52l-.43.54-1.26-1-1.28-.93-2.45-1.8c-1.6-1.15-3-2.34-4.55-3.33l-4.34-2.9c-1.41-1-2.77-1.92-4.22-2.72-1.88-1.17-3.85-2.34-5.89-3.52s-4.26-2.09-6.48-3.14c-1.11-.49-2.22-1.06-3.39-1.48l-3.52-1.3c-2.38-.84-4.77-1.75-7.27-2.37s-5-1.38-7.5-1.91l-7.64-1.4a133,133,0,0,0-15.24-1.29c-2.22-.14-4.44.4-2.27,1.23-2.19-.21-4.4-.1-6.59-.12a6.38,6.38,0,0,0-3.29.54A8.17,8.17,0,0,1,139,244l-6.52.79c-2.16.29-4.31.77-6.46,1.13l-3.22.58c-1.07.24-2.13.53-3.19.78l-6.36,1.6a104.11,104.11,0,0,0-12.66,4.49,71.1,71.1,0,0,0-12.39,6.79,54.45,54.45,0,0,0-11,10.1,44.3,44.3,0,0,0-7.64,13.88,42.4,42.4,0,0,0-1.85,7.8,39,39,0,0,0-.26,8.25,34.28,34.28,0,0,0,5.45,16.37,34.45,34.45,0,0,1-4.49-15.06A50.34,50.34,0,0,1,69.7,287c.34.09.94.24,1.73-2.16A45,45,0,0,1,84,266.15c5.18-4.61,10.39-7.25,13.67-8.16a96.13,96.13,0,0,0,10.6-3c-2,.7-4,1.46-6,2.33l.41.94a103,103,0,0,1,26.42-6.06l.15,1c1.35-.18,2.69-.46,4.05-.56,1.09.53.48.95-1.14,1.47a61.78,61.78,0,0,1-7.36,1.76c-1.53.35-3.15.82-4.81,1.23s-3.38.8-5,1.32a76.83,76.83,0,0,0-8.67,3.13l.51,1.27c1.22-.5,2.47-.95,3.71-1.38l.23.64a65.13,65.13,0,0,0-15,7.23A39.68,39.68,0,0,0,84.14,281l1-1.47,1.29-1.7,1.39-1.61c.46-.5.89-.93,1.23-1.28.25.25.45.45,1.87-.84a39.61,39.61,0,0,0-4.17,4.37,31.53,31.53,0,0,0-3.48,5.33,30,30,0,0,0-2.25,6,23.8,23.8,0,0,0-.71,5.92c.1.94.45.94.85.06s.88-2.63,1.76-5.15a30.38,30.38,0,0,1,2.68-6.6,29,29,0,0,1,4.13-5.81l.51.46a33.82,33.82,0,0,0-3.73,4.85,19.55,19.55,0,0,0-2.42,5.61c-.09.89.39.13.93-.58s1.1-1.38,1-.54a13,13,0,0,0-1.13,4.82,28.59,28.59,0,0,1,2.74-7.72,17.09,17.09,0,0,1,1.09-1.86l.59-.89.64-.83a21.82,21.82,0,0,1,2.78-3,15,15,0,0,1,2.07-1.2c.63-.25,1.12-.32,1.33-.06a28,28,0,0,1,10-5.75,29.14,29.14,0,0,1,9.32-1.55c1,.07,3.51-.69,6.6-1.33l4.76-1.14Z"
                    transform="translate(-51 -230)"
                    stroke="#e36869"
                    fill="#e36869"
                    strokeWidth="1px"
                    className="gallery__button--back-a"
                />
            </svg>
        </Link>
    )
}

export default BackButton
